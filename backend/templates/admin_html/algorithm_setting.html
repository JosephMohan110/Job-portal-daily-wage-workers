<!-- admin_html/algorithm_setting.html -->
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SkillConnect | Algorithm Settings</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --sidebar-bg: #1e293b;
            --sidebar-dark: #0f172a;
            --sidebar-light: #334155;
            --sidebar-text: #e2e8f0;
            --sidebar-hover: #334155;
            --sidebar-active: #3b82f6;
            --sidebar-border: #475569;

            --primary-color: #3b82f6;
            --secondary-color: #10b981;
            --accent-color: #f59e0b;
            --danger-color: #ef4444;
            --warning-color: #f97316;
            --success-color: #10b981;
            --info-color: #06b6d4;

            --card-bg: #ffffff;
            --body-bg: #f8fafc;
            --text-dark: #1e293b;
            --text-light: #64748b;

            --sidebar-width: 260px;
            --header-height: 70px;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', system-ui, sans-serif;
        }

        body {
            display: flex;
            background-color: var(--body-bg);
            color: var(--text-dark);
            min-height: 100vh;
        }

        /* ---------- MOBILE HEADER ---------- */
        .mobile-header {
            display: none;
            background-color: var(--sidebar-bg);
            color: var(--sidebar-text);
            height: 70px;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 1001;
            padding: 0 16px;
            align-items: center;
            justify-content: space-between;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
        }

        .mobile-header-left {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .menu-toggle {
            background: none;
            border: none;
            color: var(--sidebar-text);
            font-size: 1.5rem;
            cursor: pointer;
            width: 44px;
            height: 44px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: background-color 0.2s;
        }

        .menu-toggle:hover {
            background-color: var(--sidebar-hover);
        }

        .mobile-logo {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .mobile-logo-icon {
            width: 36px;
            height: 36px;
            background: linear-gradient(135deg, var(--primary-color), var(--info-color));
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.2rem;
        }

        .mobile-logo-text {
            font-size: 1.3rem;
            font-weight: 700;
            color: white;
            letter-spacing: -0.5px;
        }

        .mobile-notification-btn {
            position: relative;
            background: none;
            border: none;
            color: var(--sidebar-text);
            font-size: 1.2rem;
            cursor: pointer;
            width: 44px;
            height: 44px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .mobile-notification-badge {
            position: absolute;
            top: 8px;
            right: 8px;
            background-color: var(--danger-color);
            color: white;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.7rem;
            font-weight: 600;
            border: 2px solid var(--sidebar-bg);
        }

        /* ---------- SIDEBAR ---------- */
        .sidebar-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 999;
        }

        .sidebar {
            width: var(--sidebar-width);
            background: linear-gradient(180deg, var(--sidebar-dark) 0%, var(--sidebar-bg) 100%);
            color: var(--sidebar-text);
            height: 100vh;
            position: fixed;
            padding-top: 0;
            transition: all 0.3s ease;
            box-shadow: 4px 0 20px rgba(0, 0, 0, 0.1);
            z-index: 1000;
            display: flex;
            flex-direction: column;
            transform: translateX(0);
        }

        .sidebar-header {
            padding: 24px 20px;
            border-bottom: 1px solid var(--sidebar-border);
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .logo-container {
            width: 40px;
            height: 40px;
            background: linear-gradient(135deg, var(--primary-color), var(--info-color));
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.3rem;
        }

        .logo-text {
            font-size: 1.4rem;
            font-weight: 700;
            color: white;
            letter-spacing: -0.5px;
        }

        .sidebar-nav {
            flex: 1;
            padding: 20px 0;
            overflow-y: auto;
        }

        .nav-section {
            margin-bottom: 24px;
        }

        .nav-title {
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: uppercase;
            color: #94a3b8;
            letter-spacing: 0.5px;
            padding: 0 20px;
            margin-bottom: 12px;
        }

        .nav-menu {
            list-style: none;
        }

        .nav-item {
            margin: 4px 12px;
            border-radius: 8px;
            transition: all 0.2s ease;
            position: relative;
        }

        .nav-item.active {
            background-color: rgba(59, 130, 246, 0.15);
        }

        .nav-item.active .nav-link {
            color: white;
        }

        .nav-item.active::before {
            content: '';
            position: absolute;
            left: 0;
            top: 50%;
            transform: translateY(-50%);
            width: 4px;
            height: 40%;
            background-color: var(--sidebar-active);
            border-radius: 0 4px 4px 0;
        }

        .nav-item:hover:not(.active) {
            background-color: var(--sidebar-hover);
        }

        .nav-link {
            color: var(--sidebar-text);
            text-decoration: none;
            padding: 12px 16px;
            display: flex;
            align-items: center;
            gap: 12px;
            border-radius: 8px;
            font-size: 0.95rem;
            font-weight: 500;
            transition: all 0.2s ease;
        }

        .nav-icon {
            width: 20px;
            text-align: center;
            font-size: 1.1rem;
            opacity: 0.9;
        }

        .nav-item.active .nav-icon {
            color: var(--sidebar-active);
            opacity: 1;
        }

        .nav-badge {
            margin-left: auto;
            background-color: var(--danger-color);
            color: white;
            font-size: 0.7rem;
            font-weight: 600;
            padding: 2px 8px;
            border-radius: 20px;
            min-width: 20px;
            text-align: center;
        }

        .sidebar-footer {
            padding: 20px;
            border-top: 1px solid var(--sidebar-border);
        }

        .user-profile {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px;
            border-radius: 8px;
            background-color: rgba(255, 255, 255, 0.05);
            transition: background-color 0.2s ease;
        }

        .user-profile:hover {
            background-color: rgba(255, 255, 255, 0.08);
        }

        .user-avatar {
            width: 40px;
            height: 40px;
            border-radius: 10px;
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 600;
            font-size: 1.1rem;
        }

        .user-info h4 {
            font-size: 0.95rem;
            font-weight: 600;
            color: white;
            margin-bottom: 2px;
        }

        .user-info p {
            font-size: 0.8rem;
            color: #94a3b8;
        }

        /* ========== MAIN CONTENT ========== */
        .main-content {
            flex: 1;
            margin-left: var(--sidebar-width);
            padding: 24px;
            transition: margin-left 0.3s ease;
            min-height: 100vh;
            padding-top: 24px;
        }

        /* Header */
        .page-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background-color: var(--card-bg);
            padding: 20px 24px;
            border-radius: 12px;
            margin-bottom: 24px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
            border: 1px solid #e2e8f0;
        }

        .header-title h1 {
            font-size: 1.8rem;
            color: var(--text-dark);
            font-weight: 700;
            margin-bottom: 4px;
        }

        .header-title p {
            color: var(--text-light);
            font-size: 0.95rem;
        }

        .header-actions {
            display: flex;
            align-items: center;
            gap: 16px;
            flex-wrap: wrap;
        }

        .btn {
            padding: 10px 18px;
            border-radius: 8px;
            border: none;
            font-weight: 600;
            font-size: 0.9rem;
            cursor: pointer;
            transition: all 0.2s ease;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            text-decoration: none;
        }

        .btn-primary {
            background-color: var(--primary-color);
            color: white;
        }

        .btn-primary:hover {
            background-color: #2563eb;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(37, 99, 235, 0.2);
        }

        .btn-secondary {
            background-color: #f1f5f9;
            color: var(--text-dark);
            border: 1px solid #e2e8f0;
        }

        .btn-secondary:hover {
            background-color: #e2e8f0;
        }

        .btn-success {
            background-color: var(--success-color);
            color: white;
        }

        .btn-success:hover {
            background-color: #0da271;
        }

        .btn-danger {
            background-color: var(--danger-color);
            color: white;
        }

        .btn-danger:hover {
            background-color: #dc2626;
        }

        .notification-btn {
            position: relative;
            background: none;
            border: none;
            cursor: pointer;
            color: var(--text-light);
            font-size: 1.2rem;
        }

        .notification-badge {
            position: absolute;
            top: -5px;
            right: -5px;
            background-color: var(--danger-color);
            color: white;
            border-radius: 50%;
            width: 18px;
            height: 18px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.7rem;
            font-weight: 600;
        }

        .admin-profile {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 8px 16px;
            border-radius: 10px;
            background-color: #f1f5f9;
            transition: background-color 0.2s ease;
        }

        .admin-profile:hover {
            background-color: #e2e8f0;
        }

        .admin-avatar {
            width: 40px;
            height: 40px;
            border-radius: 10px;
            background: linear-gradient(135deg, var(--primary-color), var(--info-color));
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 600;
            font-size: 1.1rem;
        }

        /* ========== TABS ========== */
        .tabs-container {
            margin-bottom: 30px;
        }

        .tabs-header {
            display: flex;
            border-bottom: 2px solid #e2e8f0;
            margin-bottom: 30px;
        }

        .tab-btn {
            padding: 14px 24px;
            background: none;
            border: none;
            font-size: 1rem;
            font-weight: 600;
            color: var(--text-light);
            cursor: pointer;
            position: relative;
            transition: all 0.2s ease;
        }

        .tab-btn:hover {
            color: var(--text-dark);
        }

        .tab-btn.active {
            color: var(--primary-color);
        }

        .tab-btn.active::after {
            content: '';
            position: absolute;
            bottom: -2px;
            left: 0;
            width: 100%;
            height: 2px;
            background-color: var(--primary-color);
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
            animation: fadeIn 0.3s ease;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
            }

            to {
                opacity: 1;
            }
        }

        /* ========== DATA COLLECTION TAB ========== */
        .data-collection-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 24px;
            flex-wrap: wrap;
            gap: 15px;
        }

        .data-collection-header h2 {
            font-size: 1.4rem;
            font-weight: 700;
            color: var(--text-dark);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .data-stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .data-stat-card {
            background-color: var(--card-bg);
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
            border: 1px solid #e2e8f0;
            transition: all 0.3s ease;
        }

        .data-stat-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.08);
        }

        .data-stat-header {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 16px;
        }

        .data-stat-icon {
            width: 45px;
            height: 45px;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.3rem;
            color: white;
        }

        .data-stat-value {
            font-size: 1.8rem;
            font-weight: 700;
            color: var(--text-dark);
            margin-bottom: 4px;
        }

        .data-stat-label {
            font-size: 0.9rem;
            color: var(--text-light);
        }

        .data-table-container {
            background-color: var(--card-bg);
            border-radius: 12px;
            padding: 24px;
            margin-bottom: 30px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
            border: 1px solid #e2e8f0;
        }

        /* ========== CSV PREVIEW STYLES ========== */
        .csv-preview-container {
            background-color: #f8fafc;
            border-radius: 8px;
            padding: 20px;
            margin-top: 20px;
            border: 1px solid #e2e8f0;
            overflow: hidden;
        }

        .csv-preview-wrapper {
            overflow-x: auto;
            overflow-y: hidden;
            width: 100%;
            margin-bottom: 15px;
            -webkit-overflow-scrolling: touch;
        }

        .csv-preview-wrapper::-webkit-scrollbar {
            height: 8px;
        }

        .csv-preview-wrapper::-webkit-scrollbar-track {
            background: #e2e8f0;
            border-radius: 4px;
        }

        .csv-preview-wrapper::-webkit-scrollbar-thumb {
            background: #94a3b8;
            border-radius: 4px;
        }

        .csv-preview-wrapper::-webkit-scrollbar-thumb:hover {
            background: #64748b;
        }

        .csv-preview {
            font-family: 'Consolas', 'Monaco', monospace;
            font-size: 0.85rem;
            color: var(--text-dark);
            line-height: 1.5;
            white-space: nowrap;
            min-width: max-content;
        }

        .csv-preview pre {
            margin: 0;
            font-family: 'Consolas', 'Monaco', monospace;
        }

        .csv-preview-header {
            font-weight: bold;
            color: #1e293b;
            background-color: #f1f5f9;
            padding: 8px 12px;
            border-bottom: 2px solid #cbd5e1;
        }

        .csv-preview-row {
            padding: 8px 12px;
            border-bottom: 1px solid #e2e8f0;
        }

        .csv-preview-row:nth-child(even) {
            background-color: rgba(241, 245, 249, 0.5);
        }

        .csv-preview-row:hover {
            background-color: rgba(203, 213, 225, 0.3);
        }

        .csv-preview-footer {
            margin-top: 15px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 10px;
        }

        /* ========== RECENT EXPORTS SECTION ========== */
        .recent-exports-container {
            background-color: #f8fafc;
            padding: 20px;
            border-radius: 8px;
            border: 1px solid #e2e8f0;
            max-height: 200px;
            overflow-y: auto;
            scrollbar-width: thin;
            scrollbar-color: #94a3b8 #e2e8f0;
        }

        .recent-exports-container::-webkit-scrollbar {
            width: 6px;
        }

        .recent-exports-container::-webkit-scrollbar-track {
            background: #e2e8f0;
            border-radius: 3px;
        }

        .recent-exports-container::-webkit-scrollbar-thumb {
            background: #94a3b8;
            border-radius: 3px;
        }

        .recent-exports-container::-webkit-scrollbar-thumb:hover {
            background: #64748b;
        }

        .recent-exports-list {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        .recent-export-item {
            padding: 8px 0;
            border-bottom: 1px solid #e2e8f0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .recent-export-item:last-child {
            border-bottom: none;
        }

        /* ========== ML MODEL MANAGEMENT TAB ========== */
        .model-management-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 24px;
            flex-wrap: wrap;
            gap: 15px;
        }

        .model-management-header h2 {
            font-size: 1.4rem;
            font-weight: 700;
            color: var(--text-dark);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .model-status-badge {
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 0.9rem;
            font-weight: 600;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }

        .status-success {
            background-color: rgba(16, 185, 129, 0.1);
            color: var(--success-color);
        }

        .status-pending {
            background-color: rgba(245, 158, 11, 0.1);
            color: var(--accent-color);
        }

        .status-failed {
            background-color: rgba(239, 68, 68, 0.1);
            color: var(--danger-color);
        }

        .status-deployed {
            background-color: rgba(59, 130, 246, 0.1);
            color: var(--primary-color);
        }

        .upload-model-container {
            background-color: var(--card-bg);
            border-radius: 12px;
            padding: 24px;
            margin-bottom: 30px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
            border: 1px solid #e2e8f0;
        }

        .upload-area {
            border: 2px dashed #cbd5e1;
            border-radius: 12px;
            padding: 40px 20px;
            text-align: center;
            background-color: #f8fafc;
            transition: all 0.3s ease;
            cursor: pointer;
            margin-bottom: 20px;
        }

        .upload-area:hover {
            border-color: var(--primary-color);
            background-color: #f0f9ff;
        }

        .upload-area.dragover {
            border-color: var(--primary-color);
            background-color: #f0f9ff;
        }

        .upload-icon {
            font-size: 3rem;
            color: #cbd5e1;
            margin-bottom: 16px;
        }

        .upload-area h4 {
            font-size: 1.2rem;
            color: var(--text-dark);
            margin-bottom: 8px;
        }

        .upload-area p {
            color: var(--text-light);
            margin-bottom: 20px;
            font-size: 0.95rem;
        }

        .upload-input {
            display: none;
        }

        .upload-formats {
            display: flex;
            justify-content: center;
            gap: 12px;
            flex-wrap: wrap;
            margin-top: 20px;
        }

        .format-badge {
            padding: 6px 12px;
            background-color: #f1f5f9;
            color: var(--text-light);
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
        }

        .data-table {
            width: 100%;
            border-collapse: collapse;
            background-color: white;
            border-radius: 8px;
            border: 1px solid #e2e8f0;
            overflow: hidden;
        }

        .data-table th {
            padding: 16px;
            text-align: left;
            font-weight: 600;
            color: var(--text-dark);
            background-color: #f8fafc;
            border-bottom: 2px solid #e2e8f0;
            white-space: nowrap;
        }

        .data-table td {
            padding: 16px;
            border-bottom: 1px solid #e2e8f0;
        }

        .data-table tr:last-child td {
            border-bottom: none;
        }

        .data-table tr:hover {
            background-color: #f8fafc;
        }

        .btn-icon {
            width: 36px;
            height: 36px;
            border-radius: 8px;
            border: none;
            background-color: #f1f5f9;
            color: var(--text-dark);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s ease;
            text-decoration: none;
        }

        .btn-icon:hover {
            background-color: #e2e8f0;
        }

        /* Model Upload History Specific Styles */
        .model-filters {
            display: flex;
            flex-wrap: wrap;
            gap: 12px;
            margin-bottom: 20px;
            align-items: center;
            background-color: #f8fafc;
            padding: 16px;
            border-radius: 8px;
            border: 1px solid #e2e8f0;
        }

        .filter-group {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .filter-label {
            font-weight: 500;
            color: var(--text-dark);
            font-size: 0.9rem;
        }

        .filter-select {
            padding: 8px 12px;
            border-radius: 6px;
            border: 1px solid #e2e8f0;
            background-color: white;
            font-size: 0.9rem;
        }

        .search-box {
            padding: 8px 12px;
            border-radius: 6px;
            border: 1px solid #e2e8f0;
            background-color: white;
            font-size: 0.9rem;
            width: 200px;
        }

        .file-size {
            font-size: 0.85rem;
            color: var(--text-light);
            background-color: #f1f5f9;
            padding: 4px 8px;
            border-radius: 4px;
            display: inline-block;
        }

        .uploader-info {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .uploader-avatar {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            background-color: #e2e8f0;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.8rem;
            font-weight: 600;
            color: var(--text-dark);
        }

        .uploader-name {
            font-weight: 500;
            font-size: 0.9rem;
        }

        /* Messages */
        .messages-container {
            margin-bottom: 20px;
        }

        .alert {
            padding: 12px 16px;
            border-radius: 8px;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .alert-success {
            background-color: rgba(16, 185, 129, 0.1);
            border: 1px solid rgba(16, 185, 129, 0.2);
            color: var(--success-color);
        }

        .alert-error {
            background-color: rgba(239, 68, 68, 0.1);
            border: 1px solid rgba(239, 68, 68, 0.2);
            color: var(--danger-color);
        }

        .alert-warning {
            background-color: rgba(245, 158, 11, 0.1);
            border: 1px solid rgba(245, 158, 11, 0.2);
            color: var(--accent-color);
        }

        .alert-info {
            background-color: rgba(59, 130, 246, 0.1);
            border: 1px solid rgba(59, 130, 246, 0.2);
            color: var(--primary-color);
        }

        /* Forms */
        .form-group {
            margin-bottom: 20px;
        }

        .form-label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: var(--text-dark);
        }

        .form-control {
            width: 100%;
            padding: 10px 12px;
            border-radius: 8px;
            border: 1px solid #e2e8f0;
            font-size: 0.95rem;
            transition: border-color 0.2s;
        }

        .form-control:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
        }

        .form-row {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
        }

        /* ========== RESPONSIVE DESIGN ========== */
        @media (max-width: 992px) {
            .sidebar {
                transform: translateX(-100%);
            }

            .sidebar.active {
                transform: translateX(0);
            }

            .main-content {
                margin-left: 0;
                padding-top: calc(var(--header-height) + 20px);
            }

            .mobile-header {
                display: flex;
            }

            .sidebar-overlay.active {
                display: block;
            }

            .page-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 15px;
                padding: 20px;
            }

            .header-actions {
                width: 100%;
                justify-content: space-between;
            }
        }

        @media (max-width: 768px) {
            .tabs-header {
                flex-direction: column;
                border-bottom: none;
            }

            .tab-btn {
                border-bottom: 2px solid #e2e8f0;
                width: 100%;
                text-align: left;
            }

            .tab-btn.active::after {
                bottom: -2px;
                left: 0;
                width: 100%;
                height: 2px;
            }

            .data-table-container {
                padding: 16px;
                overflow-x: auto;
            }

            .data-stats-grid {
                grid-template-columns: repeat(2, 1fr);
            }

            .header-actions {
                flex-wrap: wrap;
                gap: 12px;
            }

            .data-collection-header,
            .model-management-header {
                flex-direction: column;
                align-items: flex-start;
            }

            .model-filters {
                flex-direction: column;
                align-items: flex-start;
            }

            .filter-group {
                width: 100%;
            }

            .search-box {
                width: 100%;
            }

            .csv-preview-footer {
                flex-direction: column;
                align-items: flex-start;
            }

            .csv-preview-footer .export-buttons {
                display: flex;
                flex-wrap: wrap;
                gap: 8px;
                margin-top: 10px;
            }
        }

        @media (max-width: 576px) {
            .main-content {
                padding: 16px;
                padding-top: calc(var(--header-height) + 16px);
            }

            .page-header {
                padding: 16px;
            }

            .header-title h1 {
                font-size: 1.5rem;
            }

            .header-title p {
                font-size: 0.9rem;
            }

            .admin-profile {
                padding: 6px 12px;
            }

            .admin-avatar {
                width: 36px;
                height: 36px;
                font-size: 1rem;
            }

            .data-stat-card {
                padding: 16px;
            }

            .data-stat-value {
                font-size: 1.5rem;
            }

            .upload-area {
                padding: 30px 15px;
            }

            .upload-icon {
                font-size: 2.5rem;
            }

            .data-stats-grid {
                grid-template-columns: 1fr;
                gap: 15px;
            }

            .csv-preview {
                font-size: 0.8rem;
            }
        }

        @media (max-width: 400px) {
            .mobile-header {
                padding: 0 12px;
            }

            .mobile-header .logo-text {
                font-size: 1.2rem;
            }

            .header-actions {
                flex-wrap: wrap;
                gap: 12px;
            }

            .admin-profile {
                order: -1;
                width: 100%;
                justify-content: center;
            }

            .notification-btn {
                position: absolute;
                top: 20px;
                right: 20px;
            }

            .btn {
                padding: 8px 14px;
                font-size: 0.85rem;
            }
        }

        /* Table scroll for mobile */
        @media (max-width: 768px) {
            .data-table {
                display: block;
                overflow-x: auto;
                white-space: nowrap;
            }
        }
    </style>
</head>

<body>

    <!-- ========== MOBILE HEADER ========== -->
    <header class="mobile-header">
        <div class="mobile-header-left">
            <button class="menu-toggle" id="menuToggle">
                <i class="fas fa-bars"></i>
            </button>
            <div class="mobile-logo">
                <div class="mobile-logo-icon">
                    <i class="fas fa-hands-helping"></i>
                </div>
                <div class="mobile-logo-text">SkillConnect</div>
            </div>
        </div>
        <button class="mobile-notification-btn">
            <i class="fas fa-bell"></i>
            <span class="mobile-notification-badge">15</span>
        </button>
    </header>

    {% include 'admin_html/admin_sidebar.html' %}

    <!-- ========== MAIN CONTENT - ALGORITHM SETTINGS ========== -->
    <main class="main-content">
        <!-- Header -->
        <header class="page-header">
            <div class="header-title">
                <h1>Algorithm Settings</h1>
                <p>Configure ML models, training data, and platform analytics</p>
            </div>
            <div class="header-actions">
                <button class="btn btn-secondary" onclick="showUploadForm()">
                    <i class="fas fa-cloud-upload-alt"></i> Upload New Model
                </button>
                {% include 'admin_html/includes/admin_notification.html' %}
                <div class="admin-profile">
                    <div class="admin-avatar">
                        {% if request.user.is_authenticated and request.user.username %}
                        {{ request.user.username.0|upper }}
                        {% else %}
                        A
                        {% endif %}
                    </div>
                    <div>
                        <h4 style="margin-bottom: 2px;">
                            {% if request.user.is_authenticated %}
                            {% if request.user.get_full_name %}
                            {{ request.user.get_full_name }}
                            {% elif request.user.username %}
                            {{ request.user.username }}
                            {% else %}
                            Administrator
                            {% endif %}
                            {% else %}
                            Administrator
                            {% endif %}
                        </h4>
                        <p style="color: var(--text-light); font-size: 0.85rem;">
                            {% if request.user.is_authenticated and request.user.email %}
                            {{ request.user.email }}
                            {% else %}
                            admin@skillconnect.com
                            {% endif %}
                        </p>
                    </div>
                </div>
            </div>
        </header>

        <!-- Messages -->
        {% if messages %}
        <div class="messages-container">
            {% for message in messages %}
            <div class="alert alert-{{ message.tags }}">
                <i class="fas 
                {% if message.tags == 'success' %}fa-check-circle
                {% elif message.tags == 'error' %}fa-exclamation-circle
                {% elif message.tags == 'warning' %}fa-exclamation-triangle
                {% else %}fa-info-circle{% endif %}"></i>
                {{ message }}
            </div>
            {% endfor %}
        </div>
        {% endif %}

        <!-- Tabs Navigation -->
        <div class="tabs-container">
            <div class="tabs-header">
                <button class="tab-btn {% if tab == 'data-collection' %}active{% endif %}" data-tab="data-collection"
                    onclick="switchTab('data-collection')">
                    <i class="fas fa-database"></i> Data Collection
                </button>
                <button class="tab-btn {% if tab == 'model-management' %}active{% endif %}" data-tab="model-management"
                    onclick="switchTab('model-management')">
                    <i class="fas fa-brain"></i> ML Model Management
                </button>
                <button class="tab-btn {% if tab == 'self-training' %}active{% endif %}" data-tab="self-training"
                    onclick="switchTab('self-training')">
                    <i class="fas fa-dumbbell"></i> Self Training
                </button>
            </div>

            <!-- ========== DATA COLLECTION TAB ========== -->
            <div id="data-collection" class="tab-content {% if tab == 'data-collection' %}active{% endif %}">
                <div class="data-collection-header">
                    <h2><i class="fas fa-database"></i> Real-Time Data Collection</h2>
                    <div style="display: flex; gap: 12px;">
                        <!-- Export Data Form -->
                        <form method="post" action="{% url 'export_data_csv' %}" style="display: inline;">
                            {% csrf_token %}
                            <input type="hidden" name="export_type" value="all">
                            <button type="submit" class="btn btn-success">
                                <i class="fas fa-file-csv"></i> Export All Data
                            </button>
                        </form>

                        <button class="btn btn-secondary" onclick="showDataSettings()">
                            <i class="fas fa-cog"></i> Collection Settings
                        </button>
                    </div>
                </div>

                <!-- Data Stats -->
                <div class="data-stats-grid">
                    <div class="data-stat-card">
                        <div class="data-stat-header">
                            <div class="data-stat-icon" style="background-color: var(--primary-color);">
                                <i class="fas fa-user-plus"></i>
                            </div>
                            <div>
                                <div class="data-stat-value">{{ total_users|floatformat:0 }}</div>
                                <div class="data-stat-label">Total Users</div>
                            </div>
                        </div>
                        <div style="font-size: 0.9rem; color: var(--text-light);">
                            <div>Workers: {{ total_workers }}</div>
                            <div>Employers: {{ total_employers }}</div>
                        </div>
                    </div>

                    <div class="data-stat-card">
                        <div class="data-stat-header">
                            <div class="data-stat-icon" style="background-color: var(--success-color);">
                                <i class="fas fa-handshake"></i>
                            </div>
                            <div>
                                <div class="data-stat-value">{{ total_bookings|floatformat:0 }}</div>
                                <div class="data-stat-label">Total Bookings</div>
                            </div>
                        </div>
                        <div style="font-size: 0.9rem; color: var(--text-light);">
                            <div>Completed: {{ completed_bookings }}</div>
                            <div>Completion Rate: {% if total_bookings > 0 %}{{ completed_bookings|floatformat:0 }}%{%
                                else %}0%{% endif %}</div>
                        </div>
                    </div>

                    <div class="data-stat-card">
                        <div class="data-stat-header">
                            <div class="data-stat-icon" style="background-color: var(--accent-color);">
                                <i class="fas fa-money-bill-wave"></i>
                            </div>
                            <div>
                                <div class="data-stat-value">₹{{ total_revenue|floatformat:0 }}</div>
                                <div class="data-stat-label">Total Revenue</div>
                            </div>
                        </div>
                        <div style="font-size: 0.9rem; color: var(--text-light);">
                            <div>Platform Commission: ₹{{ platform_commission|floatformat:2 }}</div>
                            <div>Commission Rate: 0.10%</div>
                        </div>
                    </div>

                    <div class="data-stat-card">
                        <div class="data-stat-header">
                            <div class="data-stat-icon" style="background-color: #8b5cf6;">
                                <i class="fas fa-star"></i>
                            </div>
                            <div>
                                <div class="data-stat-value">{{ avg_rating|floatformat:1 }}</div>
                                <div class="data-stat-label">Avg. Rating</div>
                            </div>
                        </div>
                        <div style="font-size: 0.9rem; color: var(--text-light);">
                            <div>Based on user reviews</div>
                            <div>Scale: 1-5 stars</div>
                        </div>
                    </div>
                </div>

                <!-- CSV Preview -->
                <div class="data-table-container">
                    <h3
                        style="margin-bottom: 20px; color: var(--text-dark); display: flex; align-items: center; gap: 8px;">
                        <i class="fas fa-file-csv"></i> CSV Data Preview (First 10 Rows)
                    </h3>

                    <div class="csv-preview-container">
                        <div class="csv-preview-wrapper">
                            <div class="csv-preview">
                                <pre>{{ csv_preview_text }}</pre>
                            </div>
                        </div>
                        <div class="csv-preview-footer">
                            <div style="font-size: 0.9rem; color: var(--text-light);">
                                Total records available: {{
                                total_users|add:total_bookings|add:total_revenue|floatformat:0 }}
                            </div>
                            <div class="export-buttons" style="display: flex; gap: 10px;">
                                <!-- Export Users Data -->
                                <form method="post" action="{% url 'export_data_csv' %}" style="display: inline;">
                                    {% csrf_token %}
                                    <input type="hidden" name="export_type" value="users">
                                    <button type="submit" class="btn btn-secondary">
                                        <i class="fas fa-user"></i> Export Users
                                    </button>
                                </form>

                                <!-- Export Bookings Data -->
                                <form method="post" action="{% url 'export_data_csv' %}" style="display: inline;">
                                    {% csrf_token %}
                                    <input type="hidden" name="export_type" value="bookings">
                                    <button type="submit" class="btn btn-secondary">
                                        <i class="fas fa-handshake"></i> Export Bookings
                                    </button>
                                </form>

                                <!-- Export Revenue Data -->
                                <form method="post" action="{% url 'export_data_csv' %}" style="display: inline;">
                                    {% csrf_token %}
                                    <input type="hidden" name="export_type" value="revenue">
                                    <button type="submit" class="btn btn-secondary">
                                        <i class="fas fa-money-bill-wave"></i> Export Revenue
                                    </button>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Data Collection Logs -->
                <div class="data-table-container">
                    <h3
                        style="margin-bottom: 20px; color: var(--text-dark); display: flex; align-items: center; gap: 8px;">
                        <i class="fas fa-history"></i> Recent Data Collection Logs
                    </h3>

                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Date & Time</th>
                                <th>Collection Type</th>
                                <th>Data Type</th>
                                <th>Records</th>
                                <th>File Size</th>
                                <th>Status</th>
                                <th>Collected By</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for log in data_logs %}
                            <tr>
                                <td>{{ log.created_at|date:"Y-m-d H:i" }}</td>
                                <td>{{ log.get_collection_type_display }}</td>
                                <td>{{ log.data_type }}</td>
                                <td>{{ log.records_collected }}</td>
                                <td><span class="file-size">{{ log.file_size_mb }} MB</span></td>
                                <td>
                                    <span class="model-status-badge 
                                    {% if log.status == 'success' %}status-success
                                    {% elif log.status == 'failed' %}status-failed
                                    {% else %}status-pending{% endif %}">
                                        {{ log.get_status_display }}
                                    </span>
                                </td>
                                <td>
                                    <div class="uploader-info">
                                        <div class="uploader-avatar">
                                            {{ log.collected_by.username|slice:":2"|upper }}
                                        </div>
                                        <span class="uploader-name">{{ log.collected_by.username }}</span>
                                    </div>
                                </td>
                            </tr>
                            {% empty %}
                            <tr>
                                <td colspan="7" style="text-align: center; color: var(--text-light); padding: 30px;">
                                    No data collection logs found.
                                </td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>

                <!-- Data Collection Actions -->
                <div class="data-table-container">
                    <h3
                        style="margin-bottom: 20px; color: var(--text-dark); display: flex; align-items: center; gap: 8px;">
                        <i class="fas fa-play-circle"></i> Data Collection Actions
                    </h3>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px;">
                        <div>
                            <h4 style="margin-bottom: 12px; color: var(--text-dark); font-size: 1rem;">Quick Data
                                Collection</h4>
                            <div
                                style="background-color: #f8fafc; padding: 20px; border-radius: 8px; border: 1px solid #e2e8f0;">
                                <p style="margin-bottom: 15px; color: var(--text-light); font-size: 0.9rem;">
                                    Trigger immediate data collection for specific data types:
                                </p>

                                <form method="post" action="{% url 'collect_data_now' %}"
                                    style="display: grid; gap: 10px;">
                                    {% csrf_token %}
                                    <input type="hidden" name="collection_type" value="manual">

                                    <div style="display: flex; gap: 10px;">
                                        <select name="data_type" class="form-control" style="flex: 1;">
                                            <option value="users">User Data</option>
                                            <option value="bookings">Booking Data</option>
                                            <option value="revenue">Revenue Data</option>
                                            <option value="all">All Data</option>
                                        </select>
                                        <button type="submit" class="btn btn-primary">
                                            <i class="fas fa-play"></i> Collect
                                        </button>
                                    </div>
                                </form>
                            </div>
                        </div>

                        <div>
                            <h4 style="margin-bottom: 12px; color: var(--text-dark); font-size: 1rem;">Recent Exports
                            </h4>
                            <div class="recent-exports-container">
                                {% if recent_exports %}
                                <ul class="recent-exports-list">
                                    {% for export in recent_exports %}
                                    <li class="recent-export-item">
                                        <div>
                                            <div style="font-weight: 500; font-size: 0.9rem;">{{ export.data_type }}
                                            </div>
                                            <div style="font-size: 0.8rem; color: var(--text-light);">{{
                                                export.created_at|timesince }} ago</div>
                                        </div>
                                        {% if export.export_file %}
                                        <a href="{{ export.export_file.url }}" class="btn-icon" title="Download">
                                            <i class="fas fa-download"></i>
                                        </a>
                                        {% endif %}
                                    </li>
                                    {% endfor %}
                                </ul>
                                {% else %}
                                <p style="color: var(--text-light); text-align: center; margin: 20px 0;">
                                    No recent exports
                                </p>
                                {% endif %}
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- ========== ML MODEL MANAGEMENT TAB ========== -->
            <div id="model-management" class="tab-content {% if tab == 'model-management' %}active{% endif %}">
                <div class="model-management-header">
                    <h2><i class="fas fa-brain"></i> Model Upload History</h2>
                    <div style="display: flex; align-items: center; gap: 12px;">
                        <button class="btn btn-primary" onclick="showUploadForm()">
                            <i class="fas fa-plus"></i> Upload New Model
                        </button>
                    </div>
                </div>

                <!-- Upload New Model Form -->
                <div class="upload-model-container" id="uploadModelContainer" style="display: none;">
                    <h3
                        style="margin-bottom: 20px; color: var(--text-dark); display: flex; align-items: center; gap: 8px;">
                        <i class="fas fa-upload"></i> Upload New ML Model
                    </h3>

                    <form method="post" action="{% url 'upload_ml_model' %}" enctype="multipart/form-data"
                        id="uploadModelForm">
                        {% csrf_token %}

                        <div class="upload-area" id="uploadArea" onclick="document.getElementById('modelFile').click()">
                            <div class="upload-icon">
                                <i class="fas fa-cloud-upload-alt"></i>
                            </div>
                            <h4>Upload your trained XGBoost model</h4>
                            <p>Click to browse or drag and drop your model file here</p>
                            <input type="file" id="modelFile" name="model_file" class="upload-input"
                                accept=".pkl,.joblib,.model" required>
                            <div class="upload-formats">
                                <span class="format-badge">.pkl (Pickle)</span>
                                <span class="format-badge">.joblib</span>
                                <span class="format-badge">.model</span>
                            </div>
                            <div id="fileName" style="margin-top: 10px; color: var(--primary-color); font-weight: 500;">
                            </div>
                        </div>


                        <!-- Model Configuration -->
                        <div style="margin-top: 30px;">
                            <h4 style="margin-bottom: 16px; color: var(--text-dark);">Model Configuration</h4>
                            <div class="form-row">
                                <div class="form-group">
                                    <label class="form-label">Model Name *</label>
                                    <input type="text" name="model_name" class="form-control" required
                                        placeholder="e.g., User Churn Predictor v2.0">
                                </div>

                                <div class="form-group" style="display: none;"> <!-- Hidden but still required -->
                                    <label class="form-label">Model Type *</label>
                                    <select name="model_type" class="form-control" required>
                                        <!-- Only show relevant options -->
                                        <option value="prediction">Platform Prediction</option>
                                        <option value="revenue" selected>Revenue Forecast</option>
                                        <option value="matching">Worker-Employer Matching</option>
                                    </select>
                                    <small style="color: var(--text-light); font-size: 0.85rem;">
                                        This model will replace the current XGBoost model
                                    </small>
                                </div>

                                <div class="form-group">
                                    <label class="form-label">Version</label>
                                    <input type="text" name="version" class="form-control" value="{% now 'Y.m.d' %}"
                                        placeholder="e.g., 2024.12.25">
                                </div>
                            </div>

                            <div class="form-group">
                                <label class="form-label">Description</label>
                                <textarea name="description" class="form-control" rows="3"
                                    placeholder="Describe the purpose and features of this model..."></textarea>
                            </div>

                            <!-- Current Model Info -->
                            <div
                                style="background-color: #f0f9ff; padding: 15px; border-radius: 8px; border-left: 4px solid var(--primary-color); margin-bottom: 20px;">
                                <h5
                                    style="margin-bottom: 10px; color: var(--primary-color); display: flex; align-items: center; gap: 8px;">
                                    <i class="fas fa-info-circle"></i> Upload Information
                                </h5>
                                <div style="font-size: 0.9rem; color: var(--text-light);">
                                    <p><strong>Standardized Filename:</strong> Your uploaded model will be automatically
                                        renamed to <code>complete_xgboost_package.pkl</code></p>
                                    <p><strong>Current Model:</strong> If a model already exists, it will be moved to
                                        the <code>old_version_model</code> folder</p>
                                    <p><strong>Auto-deployment:</strong> Uploaded models are automatically deployed and
                                        activated</p>
                                </div>
                            </div>

                            <!-- Model Parameters (Optional) -->
                            <div
                                style="margin-top: 20px; padding: 15px; background-color: #f8f9fa; border-radius: 8px;">
                                <h5 style="margin-bottom: 15px; color: var(--text-dark);">XGBoost Parameters (Optional)
                                </h5>
                                <div class="form-row">
                                    <div class="form-group">
                                        <label class="form-label">n_estimators</label>
                                        <input type="number" name="n_estimators" class="form-control" value="100"
                                            min="1">
                                        <small style="color: var(--text-light); font-size: 0.85rem;">Number of
                                            trees</small>
                                    </div>

                                    <div class="form-group">
                                        <label class="form-label">max_depth</label>
                                        <input type="number" name="max_depth" class="form-control" value="6" min="1">
                                        <small style="color: var(--text-light); font-size: 0.85rem;">Maximum tree
                                            depth</small>
                                    </div>

                                    <div class="form-group">
                                        <label class="form-label">learning_rate</label>
                                        <input type="number" step="0.01" name="learning_rate" class="form-control"
                                            value="0.3" min="0.01">
                                        <small style="color: var(--text-light); font-size: 0.85rem;">Learning
                                            rate</small>
                                    </div>
                                </div>
                            </div>

                            <div style="display: flex; justify-content: flex-end; gap: 12px; margin-top: 24px;">
                                <button type="button" class="btn btn-secondary"
                                    onclick="hideUploadForm()">Cancel</button>
                                <button type="submit" class="btn btn-primary">
                                    <i class="fas fa-upload"></i> Upload & Deploy Model
                                </button>
                            </div>
                        </div>

                    </form>
                </div>

                <!-- Model Upload History -->
                <div class="data-table-container">
                    <h3
                        style="margin-bottom: 20px; color: var(--text-dark); display: flex; align-items: center; gap: 8px;">
                        <i class="fas fa-history"></i> Model Upload History
                    </h3>

                    <!-- Filters -->
                    <div class="model-filters">
                        <form method="get" action="{% url 'algorithm_setting' %}" style="display: contents;">
                            <input type="hidden" name="tab" value="model-management">

                            <div class="filter-group">
                                <span class="filter-label">Status:</span>
                                <select name="status" class="filter-select" onchange="this.form.submit()">
                                    <option value="all" {% if status_filter == 'all' %}selected{% endif %}>All Status
                                    </option>
                                    {% for choice in status_choices %}
                                    <option value="{{ choice.0 }}" {% if status_filter == choice.0 %}selected{% endif %}>
                                        {{ choice.1 }}</option>
                                    {% endfor %}
                                </select>
                            </div>

                            <div class="filter-group">
                                <span class="filter-label">Model Type:</span>
                                <select name="type" class="filter-select" onchange="this.form.submit()">
                                    <option value="all" {% if type_filter == 'all' %}selected{% endif %}>All Types
                                    </option>
                                    {% for choice in model_type_choices %}
                                    <option value="{{ choice.0 }}" {% if type_filter == choice.0 %}selected{% endif %}>{{
                                        choice.1 }}</option>
                                    {% endfor %}
                                </select>
                            </div>

                            <div class="filter-group">
                                <span class="filter-label">Sort by:</span>
                                <select name="sort" class="filter-select" onchange="this.form.submit()">
                                    <option value="newest" {% if sort_by == 'newest' %}selected{% endif %}>Newest First
                                    </option>
                                    <option value="oldest" {% if sort_by == 'oldest' %}selected{% endif %}>Oldest First
                                    </option>
                                    <option value="name" {% if sort_by == 'name' %}selected{% endif %}>Model Name</option>
                                    <option value="size" {% if sort_by == 'size' %}selected{% endif %}>File Size</option>
                                </select>
                            </div>

                            <div class="filter-group">
                                <input type="text" name="search" class="search-box" placeholder="Search models..."
                                    value="{{ search_query }}">
                                <button type="submit" class="btn btn-secondary">
                                    <i class="fas fa-search"></i>
                                </button>
                            </div>
                        </form>
                    </div>

                    <!-- Model Upload History Table -->
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Model Name</th>
                                <th>Type</th>
                                <th>Algorithm</th>
                                <th>Uploaded On</th>
                                <th>File Size</th>
                                <th>Uploaded By</th>
                                <th>Status</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for item in model_history_data %}
                            <tr>
                                <td>
                                    <strong>{{ item.model.model_name }}</strong><br>
                                    <small>Version {{ item.model.version }}</small>
                                </td>
                                <td>{{ item.model.get_model_type_display }}</td>
                                <td>{{ item.model.algorithm }}</td>
                                <td>
                                    {{ item.model.uploaded_at|date:"Y-m-d" }}<br>
                                    <small>{{ item.model.uploaded_at|date:"H:i A" }}</small>
                                </td>
                                <td><span class="file-size">{{ item.file_size_mb }} MB</span></td>
                                <td>
                                    <div class="uploader-info">
                                        <div class="uploader-avatar">
                                            {{ item.uploader_name|slice:":2"|upper }}
                                        </div>
                                        <span class="uploader-name">{{ item.uploader_name }}</span>
                                    </div>
                                </td>
                                <td>
                                    <span class="model-status-badge {{ item.status_badge.class }}">
                                        {{ item.status_badge.text }}
                                    </span>
                                </td>
                                <td>
                                    <!-- Download Model -->
                                    <a href="{% url 'download_model_file' item.model.model_id %}" class="btn-icon"
                                        title="Download Model">
                                        <i class="fas fa-download"></i>
                                    </a>

                                    <!-- View Details -->
                                    <a href="{% url 'get_model_details' item.model.model_id %}" class="btn-icon"
                                        title="View Details">
                                        <i class="fas fa-eye"></i>
                                    </a>



                                    <!-- Status Actions -->
                                    {% if item.model.status == 'pending' %}
                                    <!-- Approve Button -->
                                    <form method="post" action="{% url 'update_model_status' item.model.model_id %}"
                                        style="display: inline;">
                                        {% csrf_token %}
                                        <input type="hidden" name="action" value="approve">
                                        <button type="submit" class="btn-icon" title="Approve Model"
                                            style="color: var(--success-color);">
                                            <i class="fas fa-check"></i>
                                        </button>
                                    </form>

                                    <!-- Reject Button -->
                                    <form method="post" action="{% url 'update_model_status' item.model.model_id %}"
                                        style="display: inline;">
                                        {% csrf_token %}
                                        <input type="hidden" name="action" value="reject">
                                        <button type="submit" class="btn-icon" title="Reject Model"
                                            style="color: var(--danger-color);">
                                            <i class="fas fa-times"></i>
                                        </button>
                                    </form>

                                    <!-- Test Button -->
                                    <form method="post" action="{% url 'update_model_status' item.model.model_id %}"
                                        style="display: inline;">
                                        {% csrf_token %}
                                        <input type="hidden" name="action" value="test">
                                        <button type="submit" class="btn-icon" title="Mark for Testing"
                                            style="color: var(--warning-color);">
                                            <i class="fas fa-vial"></i>
                                        </button>
                                    </form>

                                    {% elif item.model.status == 'testing' %}
                                    <!-- Deploy from Testing -->
                                    <form method="post" action="{% url 'update_model_status' item.model.model_id %}"
                                        style="display: inline;">
                                        {% csrf_token %}
                                        <input type="hidden" name="action" value="deploy">
                                        <button type="submit" class="btn-icon" title="Deploy Model"
                                            style="color: var(--success-color);">
                                            <i class="fas fa-rocket"></i>
                                        </button>
                                    </form>

                                    {% elif item.model.status == 'deployed' and item.model.is_active %}
                                    <!-- Deactivate Button -->
                                    <form method="post" action="{% url 'update_model_status' item.model.model_id %}"
                                        style="display: inline;">
                                        {% csrf_token %}
                                        <input type="hidden" name="action" value="deactivate">
                                        <button type="submit" class="btn-icon" title="Deactivate Model"
                                            style="color: var(--warning-color);">
                                            <i class="fas fa-pause"></i>
                                        </button>
                                    </form>

                                    <!-- Restore from Backup Button (with modal) -->
                                    <button type="button" class="btn-icon" title="Restore from Backup"
                                        style="color: var(--info-color);"
                                        onclick="showRestoreModal('{{ item.model.model_id }}')">
                                        <i class="fas fa-history"></i>
                                    </button>

                                    {% elif item.model.status == 'deployed' and not item.model.is_active %}
                                    <!-- Activate Button -->
                                    <form method="post" action="{% url 'update_model_status' item.model.model_id %}"
                                        style="display: inline;">
                                        {% csrf_token %}
                                        <input type="hidden" name="action" value="activate">
                                        <button type="submit" class="btn-icon" title="Activate Model"
                                            style="color: var(--success-color);">
                                            <i class="fas fa-play"></i>
                                        </button>
                                    </form>

                                    {% elif item.model.status == 'failed' %}
                                    <!-- Retry Button -->
                                    <form method="post" action="{% url 'update_model_status' item.model.model_id %}"
                                        style="display: inline;">
                                        {% csrf_token %}
                                        <input type="hidden" name="action" value="test">
                                        <button type="submit" class="btn-icon" title="Retry Testing"
                                            style="color: var(--warning-color);">
                                            <i class="fas fa-redo"></i>
                                        </button>
                                    </form>

                                    {% endif %}

                                    <!-- Archive Button -->
                                    {% if item.model.status != 'archived' %}
                                    <form method="post" action="{% url 'update_model_status' item.model.model_id %}"
                                        style="display: inline;">
                                        {% csrf_token %}
                                        <input type="hidden" name="action" value="archive">
                                        <button type="submit" class="btn-icon" title="Archive Model"
                                            style="color: var(--text-light);">
                                            <i class="fas fa-archive"></i>
                                        </button>
                                    </form>
                                    {% endif %}

                                    <!-- Delete Button -->
                                    <form method="post" action="{% url 'delete_model' item.model.model_id %}"
                                        style="display: inline;"
                                        onsubmit="return confirm('Are you sure you want to delete this model? This action cannot be undone.');">
                                        {% csrf_token %}
                                        <button type="submit" class="btn-icon" title="Delete Model"
                                            style="color: var(--danger-color);">
                                            <i class="fas fa-trash"></i>
                                        </button>
                                    </form>



                                </td>
                            </tr>
                            {% empty %}
                            <tr>
                                <td colspan="8" style="text-align: center; color: var(--text-light); padding: 30px;">
                                    No ML models found. <a href="#" onclick="showUploadForm(); return false;"
                                        style="color: var(--primary-color);">Upload your first model</a>
                                </td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>

                    <!-- Pagination (if needed) -->
                    {% if model_history_data|length >= 20 %}
                    <div
                        style="display: flex; justify-content: space-between; align-items: center; margin-top: 20px; padding-top: 20px; border-top: 1px solid #e2e8f0;">
                        <div style="color: var(--text-light); font-size: 0.9rem;">
                            Showing {{ model_history_data|length }} models
                        </div>
                        <div style="display: flex; gap: 8px;">
                            <button class="btn btn-secondary" style="padding: 8px 12px;">
                                <i class="fas fa-chevron-left"></i> Previous
                            </button>
                            <button class="btn btn-secondary"
                                style="padding: 8px 12px; background-color: var(--primary-color); color: white;">
                                1
                            </button>
                            <button class="btn btn-secondary" style="padding: 8px 12px;">
                                Next <i class="fas fa-chevron-right"></i>
                            </button>
                        </div>
                    </div>
                    {% endif %}
                </div>


                <!-- Restore Modal -->
                <div id="restoreModal" class="modal"
                    style="display: none; position: fixed; z-index: 1000; left: 0; top: 0; width: 100%; height: 100%; background-color: rgba(0,0,0,0.5);">
                    <div class="modal-content"
                        style="background-color: var(--card-bg); margin: 10% auto; padding: 20px; border-radius: 8px; width: 500px; max-width: 90%;">
                        <div class="modal-header"
                            style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                            <h3 style="color: var(--text-dark);">
                                <i class="fas fa-history"></i> Restore from Backup
                            </h3>
                            <span class="close-modal" onclick="closeRestoreModal()"
                                style="font-size: 28px; cursor: pointer; color: var(--text-light);">&times;</span>
                        </div>

                        <div class="modal-body">
                            <form id="restoreForm" method="post" action="">
                                {% csrf_token %}
                                <input type="hidden" name="action" value="restore">
                                <input type="hidden" id="restoreModelId" name="model_id">

                                <div class="form-group">
                                    <label class="form-label">Select Backup Version</label>
                                    <select name="version_num" class="form-control" required id="versionSelect">
                                        <option value="">Select a backup version...</option>
                                        <!-- Options will be populated by JavaScript -->
                                    </select>
                                </div>

                                <div class="form-group">
                                    <label class="form-label">Restore Notes (Optional)</label>
                                    <textarea name="notes" class="form-control" rows="3"
                                        placeholder="Add notes about why you're restoring this version..."></textarea>
                                </div>

                                <div class="modal-footer"
                                    style="display: flex; justify-content: flex-end; gap: 12px; margin-top: 20px;">
                                    <button type="button" class="btn btn-secondary"
                                        onclick="closeRestoreModal()">Cancel</button>
                                    <button type="submit" class="btn btn-primary">
                                        <i class="fas fa-history"></i> Restore & Deploy
                                    </button>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>

                <!-- Backup Management Section -->
                <div id="backupManagement"
                    style="display: none; margin-top: 20px; padding: 20px; background-color: #f8f9fa; border-radius: 8px;">
                    <h4 style="margin-bottom: 15px; color: var(--text-dark);">
                        <i class="fas fa-archive"></i> Backup Versions
                    </h4>
                    <div id="backupList">
                        <!-- Backup list will be populated here -->
                    </div>
                </div>



                <!-- Deployed Models Section -->
                {% if deployed_models %}
                <div class="data-table-container">
                    <h3
                        style="margin-bottom: 20px; color: var(--text-dark); display: flex; align-items: center; gap: 8px;">
                        <i class="fas fa-rocket"></i> Currently Deployed Models
                    </h3>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px;">
                        {% for model in deployed_models %}
                        <div
                            style="background-color: #f8fafc; padding: 20px; border-radius: 8px; border: 1px solid #e2e8f0;">
                            <div
                                style="display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 15px;">
                                <div>
                                    <h4 style="margin-bottom: 5px; color: var(--text-dark);">{{ model.model_name }}</h4>
                                    <div style="font-size: 0.9rem; color: var(--text-light);">{{
                                        model.get_model_type_display }}</div>
                                </div>
                                <span class="model-status-badge status-deployed">Active</span>
                            </div>
                            <div style="font-size: 0.9rem; color: var(--text-dark); margin-bottom: 15px;">
                                {{ model.description|truncatechars:100 }}
                            </div>
                            <div
                                style="display: flex; justify-content: space-between; align-items: center; font-size: 0.85rem; color: var(--text-light);">
                                <div>
                                    <div>Version: {{ model.version }}</div>
                                    <div>Deployed: {{ model.deployed_at|date:"M d, Y" }}</div>
                                </div>
                                <div style="display: flex; gap: 8px;">
                                    <a href="{% url 'download_model_file' model.model_id %}" class="btn-icon"
                                        title="Download">
                                        <i class="fas fa-download"></i>
                                    </a>
                                    <a href="{% url 'get_model_details' model.model_id %}" class="btn-icon"
                                        title="Details">
                                        <i class="fas fa-info-circle"></i>
                                    </a>
                                </div>
                            </div>
                        </div>
                        {% endfor %}
                    </div>
                </div>
                {% endif %}
            </div>

            <!-- ========== SELF TRAINING TAB ========== -->
            <div id="self-training" class="tab-content {% if tab == 'self-training' %}active{% endif %}">
                <div class="model-management-header">
                    <h2><i class="fas fa-dumbbell"></i> Self Learning & Training</h2>
                    <div style="display: flex; align-items: center; gap: 12px;">
                        <button class="btn btn-primary" onclick="startSelfTraining()">
                            <i class="fas fa-play"></i> Start New Training Session
                        </button>
                    </div>
                </div>

                <!-- Training Configuration (Hidden by default, shown when Start New Training is clicked) -->
                <div class="upload-model-container" id="trainingConfigContainer" style="display: none;">
                    <h3
                        style="margin-bottom: 20px; color: var(--text-dark); display: flex; align-items: center; gap: 8px;">
                        <i class="fas fa-sliders-h"></i> Configure Self Training
                    </h3>

                    <form method="post" action="{% url 'start_self_training' %}" id="trainingForm">
                        {% csrf_token %}
                        <div class="alert alert-info">
                            <i class="fas fa-info-circle"></i>
                            The system will automatically collect new data from the platform and retrain the XGBoost
                            model.
                        </div>

                        <div class="form-row">
                            <div class="form-group">
                                <label class="form-label">Training Data Source</label>
                                <select name="data_source" class="form-control">
                                    <option value="combined" selected>All Available Data (Recommended)</option>
                                    <option value="user_data">User Data Only</option>
                                    <option value="booking_data">Booking Data Only</option>
                                    <option value="revenue_data">Revenue Data Only</option>
                                </select>
                            </div>

                            <div class="form-group">
                                <label class="form-label">Model Version Strategy</label>
                                <select name="version_strategy" class="form-control">
                                    <option value="minor" selected>Increment Minor Version (e.g., 1.1.0 -> 1.2.0)
                                    </option>
                                    <option value="patch">Increment Patch Version (e.g., 1.1.0 -> 1.1.1)</option>
                                    <option value="major">Increment Major Version (e.g., 1.0.0 -> 2.0.0)</option>
                                </select>
                            </div>
                        </div>

                        <div style="background-color: #f8fafc; padding: 16px; border-radius: 8px; margin-top: 10px;">
                            <h4 style="font-size: 1rem; margin-bottom: 12px; color: var(--text-dark);">Training
                                Parameters (Advanced)</h4>
                            <div class="form-row">
                                <div class="form-group">
                                    <label class="form-label">Limit Training Samples</label>
                                    <select name="sample_limit" class="form-control">
                                        <option value="0" selected>Use All Records</option>
                                        <option value="1000">Last 1,000 Records</option>
                                        <option value="5000">Last 5,000 Records</option>
                                        <option value="10000">Last 10,000 Records</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Test Split Ratio</label>
                                    <select name="test_split" class="form-control">
                                        <option value="0.2" selected>20% (Standard)</option>
                                        <option value="0.3">30% (Robust Evaluation)</option>
                                        <option value="0.1">10% (Maximize Training)</option>
                                    </select>
                                </div>
                            </div>
                        </div>

                        <div style="display: flex; justify-content: flex-end; gap: 12px; margin-top: 24px;">
                            <button type="button" class="btn btn-secondary"
                                onclick="hideTrainingConfig()">Cancel</button>
                            <button type="submit" class="btn btn-primary">
                                <i class="fas fa-rocket"></i> Start Training
                            </button>
                        </div>
                    </form>
                </div>

                <!-- Training History Table -->
                <div class="data-table-container">
                    <h3
                        style="margin-bottom: 20px; color: var(--text-dark); display: flex; align-items: center; gap: 8px;">
                        <i class="fas fa-history"></i> Training Session History
                    </h3>

                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Date & Time</th>
                                <th>Model Version</th>
                                <th>Data Source</th>
                                <th>Samples</th>
                                <th>Accuracy</th>
                                <th>Status</th>
                                <th>Duration</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for session in training_history %}
                            <tr>
                                <td>
                                    {{ session.created_at|date:"Y-m-d" }}<br>
                                    <small>{{ session.created_at|date:"H:i A" }}</small>
                                </td>
                                <td>
                                    <strong>v{{ session.ml_model.version }}</strong>
                                </td>
                                <td>{{ session.get_data_source_display }}</td>
                                <td>{{ session.total_samples }}</td>
                                <td>
                                    {% if session.ml_model.accuracy_score %}
                                    <span style="color: var(--success-color); font-weight: 600;">{{
                                        session.ml_model.accuracy_score|floatformat:2 }}%</span>
                                    {% else %}
                                    -
                                    {% endif %}
                                </td>
                                <td>
                                    <span class="model-status-badge 
                                    {% if session.ml_model.status == 'deployed' %}status-deployed
                                    {% elif session.ml_model.status == 'failed' %}status-failed
                                    {% else %}status-pending{% endif %}">
                                        {{ session.ml_model.get_status_display }}
                                    </span>
                                </td>
                                <td>
                                    {% if session.duration_seconds %}
                                    {{ session.duration_seconds|floatformat:1 }}s
                                    {% else %}
                                    -
                                    {% endif %}
                                </td>
                            </tr>
                            {% empty %}
                            <tr>
                                <td colspan="7" style="text-align: center; color: var(--text-light); padding: 30px;">
                                    No training sessions recorded yet. Start a new session to improve your model!
                                </td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </main>

    <script>
        document.addEventListener('DOMContentLoaded', function () {
            const menuToggle = document.getElementById('menuToggle');
            const sidebar = document.getElementById('sidebar');
            const sidebarOverlay = document.getElementById('sidebarOverlay');

            // Toggle sidebar on mobile
            menuToggle.addEventListener('click', function () {
                sidebar.classList.toggle('active');
                sidebarOverlay.classList.toggle('active');
                document.body.style.overflow = sidebar.classList.contains('active') ? 'hidden' : '';
            });

            // Close sidebar when clicking on overlay
            sidebarOverlay.addEventListener('click', function () {
                sidebar.classList.remove('active');
                sidebarOverlay.classList.remove('active');
                document.body.style.overflow = '';
            });

            // File upload handling
            const modelFileInput = document.getElementById('modelFile');
            const fileNameDisplay = document.getElementById('fileName');

            if (modelFileInput && fileNameDisplay) {
                modelFileInput.addEventListener('change', function () {
                    if (this.files.length > 0) {
                        const file = this.files[0];
                        const fileSize = (file.size / (1024 * 1024)).toFixed(2);
                        fileNameDisplay.textContent = `${file.name} (${fileSize} MB)`;
                        fileNameDisplay.style.color = 'var(--success-color)';
                    } else {
                        fileNameDisplay.textContent = '';
                    }
                });

                // Drag and drop functionality
                const uploadArea = document.getElementById('uploadArea');
                if (uploadArea) {
                    uploadArea.addEventListener('dragover', function (e) {
                        e.preventDefault();
                        this.classList.add('dragover');
                    });

                    uploadArea.addEventListener('dragleave', function () {
                        this.classList.remove('dragover');
                    });

                    uploadArea.addEventListener('drop', function (e) {
                        e.preventDefault();
                        this.classList.remove('dragover');

                        const files = e.dataTransfer.files;
                        if (files.length > 0) {
                            modelFileInput.files = files;
                            const file = files[0];
                            const fileSize = (file.size / (1024 * 1024)).toFixed(2);
                            fileNameDisplay.textContent = `${file.name} (${fileSize} MB)`;
                            fileNameDisplay.style.color = 'var(--success-color)';
                        }
                    });
                }
            }

            // Check if we should show upload form based on URL parameter
            const urlParams = new URLSearchParams(window.location.search);
            if (urlParams.get('showUpload') === 'true') {
                showUploadForm();
            }

            // Format CSV preview for better readability
            formatCsvPreview();
        });

        function switchTab(tabName) {
            // Update URL without page reload
            const url = new URL(window.location);
            url.searchParams.set('tab', tabName);
            window.history.pushState({}, '', url);

            // Update active tab button
            document.querySelectorAll('.tab-btn').forEach(btn => {
                btn.classList.remove('active');
                if (btn.getAttribute('data-tab') === tabName) {
                    btn.classList.add('active');
                }
            });

            // Update active tab content
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
                if (content.id === tabName) {
                    content.classList.add('active');
                }
            });

            // Scroll to top of tab content
            document.getElementById(tabName).scrollIntoView({ behavior: 'smooth', block: 'start' });
        }

        function showUploadForm() {
            document.getElementById('uploadModelContainer').style.display = 'block';
            switchTab('model-management');

            // Scroll to upload form
            setTimeout(() => {
                document.getElementById('uploadModelContainer').scrollIntoView({ behavior: 'smooth', block: 'start' });
            }, 300);
        }

        function hideUploadForm() {
            document.getElementById('uploadModelContainer').style.display = 'none';
            // Reset form
            const form = document.getElementById('uploadModelForm');
            if (form) {
                form.reset();
                document.getElementById('fileName').textContent = '';
            }
        }

        function showDataSettings() {
            alert('Data collection settings would open here in a real implementation.');
        }

        function formatCsvPreview() {
            const csvPreview = document.querySelector('.csv-preview pre');
            if (!csvPreview) return;

            const text = csvPreview.textContent;
            const lines = text.split('\n');

            if (lines.length > 0) {
                const header = lines[0];
                const dataLines = lines.slice(1, Math.min(lines.length, 11)); // First 10 data rows + header

                let formattedHTML = '';

                // Format header
                const headers = header.split(',');
                formattedHTML += '<div class="csv-preview-header">' + headers.join(', ') + '</div>';

                // Format data rows
                dataLines.forEach((line, index) => {
                    if (line.trim()) {
                        formattedHTML += '<div class="csv-preview-row">' + line + '</div>';
                    }
                });

                csvPreview.innerHTML = formattedHTML;
            }
        }

        // Handle browser back/forward buttons
        window.addEventListener('popstate', function () {
            const urlParams = new URLSearchParams(window.location.search);
            const tab = urlParams.get('tab') || 'data-collection';
            switchTab(tab);
        });

        // Initialize tab based on current URL
        const urlParams = new URLSearchParams(window.location.search);
        const initialTab = urlParams.get('tab') || 'data-collection';
        switchTab(initialTab);



        // Add this to the existing JavaScript section
        function updateFileInfo() {
            const modelFileInput = document.getElementById('modelFile');
            const fileNameDisplay = document.getElementById('fileName');

            if (modelFileInput && fileNameDisplay) {
                modelFileInput.addEventListener('change', function () {
                    if (this.files.length > 0) {
                        const file = this.files[0];
                        const fileSize = (file.size / (1024 * 1024)).toFixed(2);

                        // Show both original and standardized filename
                        fileNameDisplay.innerHTML = `
                            <div style="margin-bottom: 5px;">
                                <strong>Original:</strong> ${file.name} (${fileSize} MB)
                            </div>
                            <div style="color: var(--success-color);">
                                <strong>Will be saved as:</strong> complete_xgboost_package.pkl
                            </div>
                        `;
                    } else {
                        fileNameDisplay.textContent = '';
                    }
                });

                // Drag and drop functionality
                const uploadArea = document.getElementById('uploadArea');
                if (uploadArea) {
                    uploadArea.addEventListener('dragover', function (e) {
                        e.preventDefault();
                        this.classList.add('dragover');
                    });

                    uploadArea.addEventListener('dragleave', function () {
                        this.classList.remove('dragover');
                    });

                    uploadArea.addEventListener('drop', function (e) {
                        e.preventDefault();
                        this.classList.remove('dragover');

                        const files = e.dataTransfer.files;
                        if (files.length > 0) {
                            modelFileInput.files = files;
                            const file = files[0];
                            const fileSize = (file.size / (1024 * 1024)).toFixed(2);

                            fileNameDisplay.innerHTML = `
                                <div style="margin-bottom: 5px;">
                                    <strong>Original:</strong> ${file.name} (${fileSize} MB)
                                </div>
                                <div style="color: var(--success-color);">
                                    <strong>Will be saved as:</strong> complete_xgboost_package.pkl
                                </div>
                            `;
                        }
                    });
                }
            }
        }




        // Show restore modal
        function showRestoreModal(modelId) {
            document.getElementById('restoreModelId').value = modelId;
            document.getElementById('restoreForm').action = `/admin_self/algorithm/model/${modelId}/update-status/`;

            // Fetch backup versions
            fetch('/admin_self/algorithm/old-models/')
                .then(response => response.json())
                .then(data => {
                    const versionSelect = document.getElementById('versionSelect');
                    versionSelect.innerHTML = '<option value="">Select a backup version...</option>';

                    if (data.old_models && data.old_models.length > 0) {
                        data.old_models.forEach(backup => {
                            const option = document.createElement('option');
                            option.value = backup.filename.replace('xgboost_model_', '').replace('.pkl', '');
                            option.textContent = `Version ${backup.filename.replace('xgboost_model_', '').replace('.pkl', '')} - ${backup.size_mb} MB - ${new Date(backup.modified).toLocaleString()}`;
                            versionSelect.appendChild(option);
                        });

                        // Show backup management section
                        showBackupManagement(data.old_models);
                    } else {
                        versionSelect.innerHTML += '<option value="" disabled>No backups available</option>';
                        document.getElementById('backupManagement').style.display = 'none';
                    }
                });

            document.getElementById('restoreModal').style.display = 'block';
        }

        // Close restore modal
        function closeRestoreModal() {
            document.getElementById('restoreModal').style.display = 'none';
        }

        function startSelfTraining() {
            document.getElementById('trainingConfigContainer').style.display = 'block';
            document.getElementById('trainingConfigContainer').scrollIntoView({ behavior: 'smooth', block: 'start' });
        }

        function hideTrainingConfig() {
            document.getElementById('trainingConfigContainer').style.display = 'none';
        }

        // Show backup management
        function showBackupManagement(backups) {
            const backupList = document.getElementById('backupList');
            backupList.innerHTML = '';

            if (backups.length === 0) {
                backupList.innerHTML = '<p style="color: var(--text-light); text-align: center;">No backup versions available.</p>';
                return;
            }

            // Create table for backups
            let tableHTML = `
                <table class="data-table" style="width: 100%;">
                    <thead>
                        <tr>
                            <th>Version</th>
                            <th>Size</th>
                            <th>Modified</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody>
            `;

            backups.forEach(backup => {
                const versionNum = backup.filename.replace('xgboost_model_', '').replace('.pkl', '');
                const modifiedDate = new Date(backup.modified).toLocaleString();

                tableHTML += `
                    <tr>
                        <td>Version ${versionNum}</td>
                        <td>${backup.size_mb} MB</td>
                        <td>${modifiedDate}</td>
                        <td>
                            <form method="post" action="/admin_self/algorithm/model/0/update-status/" style="display: inline;">
                                {% csrf_token %}
                                <input type="hidden" name="action" value="download_backup">
                                <input type="hidden" name="version_num" value="${versionNum}">
                                <button type="submit" class="btn-icon" title="Download Backup" style="color: var(--info-color);">
                                    <i class="fas fa-download"></i>
                                </button>
                            </form>
                            <form method="post" action="/admin_self/algorithm/model/0/update-status/" style="display: inline;"
                                onsubmit="return confirm('Are you sure you want to delete backup version ${versionNum}?');">
                                {% csrf_token %}
                                <input type="hidden" name="action" value="delete_backup">
                                <input type="hidden" name="version_num" value="${versionNum}">
                                <button type="submit" class="btn-icon" title="Delete Backup" style="color: var(--danger-color);">
                                    <i class="fas fa-trash"></i>
                                </button>
                            </form>
                        </td>
                    </tr>
                `;
            });

            tableHTML += `
                    </tbody>
                </table>
            `;

            backupList.innerHTML = tableHTML;
            document.getElementById('backupManagement').style.display = 'block';
        }

        // Close modal when clicking outside
        window.onclick = function (event) {
            const modal = document.getElementById('restoreModal');
            if (event.target == modal) {
                closeRestoreModal();
            }
        }
    </script>
</body>

</html>